# Review Old Backup and Unreferenced Files for Sensitive Information (fa-IR)

فایل های پشتیبان قدیمی و بدون مرجع را برای اطلاعات حساس مرور کنید (فارسی)

|شناسه          |
|------------|
|WSTG-CONF-04|

## خلاصه

در حالی که بیشتر فایل‌های داخل یک وب سرور مستقیماً توسط خود سرور مدیریت می‌شوند، یافتن فایل‌های ارجاع‌نشده یا فراموش‌شده‌ای که می‌توان از آنها برای به دست آوردن اطلاعات مهم در مورد زیرساخت یا اعتبارنامه‌ها استفاده کرد، غیرمعمول نیست.

رایج‌ترین سناریوها شامل وجود نسخه‌های قدیمی تغییر نام‌داده‌شده از فایل‌های اصلاح‌شده، فایل‌های گنجانده‌شده که به زبان انتخابی بارگیری می‌شوند و می‌توانند به عنوان منبع دانلود شوند، یا حتی پشتیبان‌گیری خودکار یا دستی در قالب بایگانی‌های فشرده است. فایل‌های پشتیبان را می‌توان به‌طور خودکار توسط سیستم فایلی که برنامه روی آن میزبانی می‌شود، تولید کرد، ویژگی که معمولاً به آن "عکس‌های فوری (snapshots)" می‌گویند.

همه این فایل‌ها ممکن است به آزمایش‌کننده اجازه دسترسی به کارهای داخلی، درهای پشتی، رابط‌های اداری، یا حتی اعتبار برای اتصال به رابط اداری یا سرور پایگاه داده را بدهند.

یک منبع مهم آسیب‌پذیری در فایل‌هایی نهفته است که هیچ ارتباطی با برنامه ندارند، اما در نتیجه ویرایش فایل‌های برنامه، یا پس از ایجاد نسخه‌های پشتیبان در جریان، یا با گذاشتن فایل‌های قدیمی یا بدون مرجع در درخت وب ایجاد می‌شوند. انجام ویرایش در محل یا سایر اقدامات مدیریتی بر روی سرورهای وب تولیدی ممکن است به طور ناخواسته نسخه‌های پشتیبان را برجای بگذارد، یا به‌طور خودکار توسط ویرایشگر هنگام ویرایش فایل‌ها یا توسط مدیری که مجموعه‌ای از فایل‌ها را فشرده می‌کند تا یک نسخه پشتیبان ایجاد کند، ایجاد می‌شود.

به راحتی می توان چنین فایل هایی را فراموش کرد و این ممکن است یک تهدید امنیتی جدی برای برنامه باشد. این اتفاق می‌افتد زیرا ممکن است نسخه‌های پشتیبان با پسوندهای فایل متفاوت از فایل‌های اصلی تولید شوند. یک بایگانی `tar`، `.zip.` یا `gz.` که ما تولید می کنیم (و فراموش می کنیم...) بدیهی است که پسوند متفاوتی دارد، و همین امر در مورد کپی های خودکار ایجاد شده توسط بسیاری از ویرایشگرها اتفاق می افتد (به عنوان مثال، emacs هنگام ویرایش `file`، یک نسخه پشتیبان بنام `~file` ایجاد می کند). کپی کردن با دست ممکن است همان اثر را ایجاد کند (به کپی کردن `file` در `file.old` فکر کنید). سیستم فایل زیربنایی که برنامه روی آن قرار دارد می‌تواند بدون اطلاع شما در مقاطع مختلف زمانی از برنامه شما `snapshots` (عکس‌های فوری) تهیه کند، که ممکن است از طریق وب نیز قابل دسترسی باشد، که تهدیدی مشابه اما متفاوت با سبک `backup file` (فایل پشتیبان) برای برنامه شما ایجاد می‌کند.

در نتیجه، این فعالیت‌ها فایل‌هایی تولید می‌کنند که مورد نیاز برنامه نیستند و ممکن است متفاوت از فایل اصلی توسط وب سرور مدیریت شوند. برای مثال، اگر یک کپی از `login.asp` بنام `login.asp.old` ایجاد کنیم، به کاربران اجازه می‌دهیم کد منبع `login.asp` را دانلود کنند. این به این دلیل است که `login.asp.old` معمولاً به‌عنوان متن یا ساده ارائه می‌شود، نه اینکه به دلیل پسوند آن اجرا شود. به عبارت دیگر، دسترسی `login.asp` باعث اجرای کد سمت سرور `login.asp` می شود، در حالی که دسترسی `login.asp.old` باعث می شود محتوای `login.asp.old` (که دوباره کد سمت سرور است) به طور واضح به کاربر بازگردانده شود و در مرورگر نمایش داده شود. این ممکن است خطرات امنیتی ایجاد کند، زیرا ممکن است اطلاعات حساس فاش شود.

به طور کلی، افشای کد سمت سرور ایده بدی است. نه تنها منطق کسب و کار را به طور غیر ضروری افشا می کنید، بلکه ممکن است ناآگاهانه اطلاعات مربوط به برنامه را که ممکن است به مهاجم کمک کند (نام مسیرها، ساختارهای داده و غیره) فاش کنید. ناگفته نماند که اسکریپت های بسیار زیادی با نام کاربری و رمز عبور تعبیه شده در متن واضح وجود دارد (که یک عمل بی دقت و بسیار خطرناک است).

دلایل دیگر فایل‌های ارجاع‌نشده به دلیل انتخاب‌های طراحی یا پیکربندی است که اجازه می‌دهند انواع فایل‌های مرتبط با برنامه مانند فایل‌های داده، فایل‌های پیکربندی، فایل‌های گزارش، در فهرست‌های سیستم فایل ذخیره شوند که توسط وب سرور قابل دسترسی است. این فایل‌ها معمولاً دلیلی برای قرار گرفتن در یک فضای فایل سیستمی ندارند که می‌توان از طریق وب به آن‌ها دسترسی پیدا کرد، زیرا باید فقط در سطح برنامه، توسط خود برنامه (و نه توسط کاربر معمولی در حال مرور اطراف) به آنها دسترسی داشت.

### تهدیدها (Threats)

فایل‌های قدیمی، پشتیبان‌گیری و بدون مرجع، تهدیدات مختلفی را برای امنیت یک برنامه وب ایجاد می‌کنند:

- فایل‌های بدون مرجع (unreferenced files) ممکن است اطلاعات حساسی را فاش کنند که می‌تواند حمله متمرکز علیه برنامه را تسهیل کند. برای مثال شامل فایل‌های حاوی اعتبار پایگاه داده، فایل‌های پیکربندی حاوی ارجاع به سایر محتوای پنهان، مسیرهای فایل مطلق و غیره باشد.
- صفحات بدون مرجع (unreferenced pages) ممکن است دارای عملکرد قدرتمندی باشند که می تواند برای حمله به برنامه استفاده شود. به عنوان مثال یک صفحه مدیریت که از محتوای منتشر شده پیوند داده نشده است، اما هر کاربری که می داند کجا آن را پیدا کند می تواند به آن دسترسی داشته باشد.
- فایل‌های قدیمی و پشتیبان ممکن است حاوی آسیب‌پذیری‌هایی باشند که در نسخه‌های اخیر برطرف شده‌اند. برای مثال `viewdoc.old.jsp` ممکن است حاوی یک آسیب‌پذیری پیمایش دایرکتوری (directory traversal vulnerability) باشد که در `viewdoc.jsp` رفع شده است، اما همچنان می‌تواند توسط هرکسی که نسخه قدیمی را پیدا کند مورد سوء استفاده قرار گیرد.
- فایل های پشتیبان ممکن است کد منبع صفحات طراحی شده برای اجرا در سرور را فاش کنند. برای مثال درخواست `viewdoc.bak` ممکن است کد منبع برای `viewdoc.jsp` را بازگرداند، که می‌توان آن را برای آسیب‌پذیری‌هایی که ممکن است با درخواست‌های کور به صفحه اجرایی یافتن آنها دشوار باشد، بررسی کرد. در حالی که این تهدید به وضوح در مورد زبان های اسکریپت شده مانند Perl، PHP، ASP، shell scripts، JSP و غیره اعمال می شود، همانطور که در مثال ارائه شده در گلوله بعدی نشان داده شده است، به آنها محدود نمی شود.
- آرشیوهای پشتیبان ممکن است حاوی کپی هایی از تمام فایل های داخل (یا حتی خارج) وبروت باشند. این به مهاجم اجازه می دهد تا به سرعت کل برنامه، از جمله صفحات بدون ارجاع، کد منبع، شامل فایل ها و غیره را برشمرد. به عنوان مثال، اگر فایلی به نام `myservlets.jar.old` فایل حاوی (کپی پشتیبان) کلاس های پیاده سازی servlet خود را فراموش کنید، موارد زیادی را در معرض نمایش قرار داده اید. اطلاعات حساسی که مستعد کامپایل کردن و مهندسی معکوس هستند.
- در برخی موارد کپی کردن یا ویرایش یک فایل پسوند فایل را تغییر نمی دهد، اما نام فایل را تغییر می دهد. این اتفاق برای مثال در محیط‌های ویندوز رخ می‌دهد، جایی که عملیات کپی کردن فایل، نام فایل‌هایی را با پیشوند "Copy of" یا نسخه‌های محلی این رشته تولید می‌کند. از آنجایی که پسوند فایل بدون تغییر باقی مانده است، این موردی نیست که یک فایل اجرایی به عنوان متن ساده توسط وب سرور برگردانده شود، و بنابراین موردی برای افشای کد منبع نیست. با این حال، این فایل‌ها نیز خطرناک هستند، زیرا این احتمال وجود دارد که دارای منطق منسوخ و نادرست باشند که در صورت فراخوانی، خطاهای برنامه را ایجاد کند، که در صورت فعال بودن نمایش پیام تشخیصی، ممکن است اطلاعات ارزشمندی را به مهاجم ارائه دهد.
- فایل‌های گزارش ممکن است حاوی اطلاعات حساسی درباره فعالیت‌های کاربران برنامه باشد، برای مثال داده‌های حساس ارسال شده در پارامترهای URL، شناسه‌های جلسه، نشانی‌های اینترنتی بازدید شده (که ممکن است محتوای غیر ارجاع‌نشده اضافی را فاش کند)، و غیره. سایر فایل‌های گزارش (مانند گزارش‌های ftp) ممکن است حاوی اطلاعات حساس در مورد نگهداری برنامه توسط مدیران سیستم باشند.
- عکس‌های فوری سیستم فایل (file system snapshots) ممکن است حاوی کپی‌هایی از کدهایی باشد که حاوی آسیب‌پذیری‌هایی هستند که در نسخه‌های اخیر برطرف شده‌اند. به عنوان مثال `snapshot/monthly.1/view.php./` ممکن است حاوی یک آسیب‌پذیری پیمایش دایرکتوری باشد که در `view.php/` رفع شده است، اما همچنان می‌تواند توسط هر کسی که نسخه قدیمی را پیدا می‌کند مورد سوء استفاده قرار گیرد.

## اهداف آزمایش
